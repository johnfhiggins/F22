Xmat <- read_csv("Xmat.csv")
probit_wm <- glm(walmart ~ log_pop + log_ret + urban_pct + midwest + south + kmart, family = binomial(link = "probit"), data = Xmat)
probit_km <- glm(kmart ~ log_pop + log_ret + urban_pct + midwest + south + walmart, family = binomial(link = "probit"), data = Xmat)
summary(probit_wm)
summary(probit_km)
Xmat$large_stores <- Xmat$walmart + Xmat$kmart
Xmat$all_stores <- Xmat$large_stores + Xmat$small_stores
Xmat$large_st_ordered <- as.ordered(Xmat$large_stores)
Xmat$all_st_ordered <- as.ordered(Xmat$all_stores)
ordered_prob_WK <- polr(large_st_ordered ~ log_pop +  log_ret + urban_pct + midwest + south, data=Xmat, method= c("probit"))
ordered_prob_all <- polr(all_st_ordered ~ log_pop +  log_ret + urban_pct + midwest + south, data=Xmat, method= c("probit"))
summary(ordered_prob_WK)
summary(ordered_prob_all)
predict(probit_wm, data, type="response", se.fit=TRUE)[-3]
predict(probit_wm, Xmat, type="response", se.fit=TRUE)[-3]
pred = predict(probit_wm, Xmat, type="response", se.fit=TRUE)[-3]
plot(pred)
histogram(pred)
hist(pred)
hist(c(pred)
hist(c(pred))
hist(c(pred))
type(pred)
typeof(pred)
pred = predict(probit_wm, Xmat, type="response", se.fit=TRUE)
pred
hist(c(pred))
hist(pred)
hist(as.numeric(pred)
hist(as.numeric(pred))
hist(as.numeric(pred))
pred = predict(probit_wm, Xmat, type="response", se.fit=TRUE)[-3]
hist(as.numeric(pred))
pred = predict(probit_wm, Xmat, type="response")[-3]
hist(as.numeric(pred))
pred[pred=0]
pred[pred>0]
pred[pred<0.001]
pred[pred>0.999]
pred_wm = predict(probit_wm, Xmat, type="response")[-3]
pred_km = predict(probit_km, Xmat, type="response")[-3]
hist(as.numeric(pred_wm))
hist(as.numeric(pred_km))
Xmat$pred_wm <- as.numeric(pred_wm)
Xmat$pred_km <- as.numeric(pred_km)
pred_wm = predict(probit_wm, Xmat, type="response")[-2]
pred_km = predict(probit_km, Xmat, type="response")[-2]
hist(as.numeric(pred_wm))
hist(as.numeric(pred_km))
Xmat$pred_wm <- as.numeric(pred_wm)
pred_wm = predict(probit_wm, Xmat, type="response")
pred_km = predict(probit_km, Xmat, type="response")
hist(as.numeric(pred_wm))
hist(as.numeric(pred_km))
Xmat$pred_wm <- as.numeric(pred_wm)
Xmat$pred_km <- as.numeric(pred_km)
plot(pred_wm, pred_km)
plot(pred_km, pred_wm)
install.packages('ivprobit')
#probit with benton county distance IV
library(ivprobit)
iv_prob_WM <- ivprobit(walmart ~ log_pop + log_ret + urban_pct + midwest + south + kmart | log_benton_dist, Xmat)
iv_prob_KM <- ivprobit(kmart ~ log_pop + log_ret + urban_pct + midwest + south | walmart | log_benton_dist, Xmat)
iv_prob_KM <- ivprobit(kmart ~ log_pop + log_ret + urban_pct + midwest + south | walmart | log_pop + log_ret + urban_pct + midwest + south +log_benton_dist, Xmat)
summary(iv_prob_KM)
pred_km_prob <- predict(iv_prob_KM, Xmat, type="response")
predict(iv_prob_KM)
fitted(iv_prob_KM)
fitted(iv_prob_KM, Xmat)
fitted(ivprobit)
fitted(pred_km_prob)
pred_km_prob <- predict(iv_prob_KM, Xmat, type="response")
pred_km_prob <- fitted(iv_prob_KM, Xmat, type="response")
Xmat$pih_w <- log(Xmat$pred_wm) - log(1-Xmat$pred_wm)
Xmat$pih_k <- log(Xmat$pred_km) - log(1-Xmat$pred_km)
Xmat$pih_w <- qnorm(Xmat$pred_wm) #log(Xmat$pred_wm) - log(1-Xmat$pred_wm)
Xmat$pih_k <- qnorm(Xmat$pred_km) #log(Xmat$pred_km) - log(1-Xmat$pred_km)
walmart_reg <- lm(pih_w ~ log_pop + log_ret + urban_pct + midwest + south+ kmart, Xmat)
kmart_reg <- lm(pih_k ~ log_pop + log_ret + urban_pct + midwest + south+ walmart, Xmat)
summary(walmart_reg)
summary(kmart_reg)
w_reg <- glm(walmart ~ log_pop + log_ret + urban_pct + midwest + south + log_benton_dist, family = binomial(link = "probit"), data = Xmat)
w_reg <- glm(walmart ~ log_pop + log_ret + urban_pct + midwest + south + log_benton_dist, family = binomial(link = "probit"), data = Xmat)
k_reg <- glm(kmart ~ log_pop + log_ret + urban_pct + midwest + south + walmart, family = binomial(link = "probit"), data = Xmat))
k_reg <- glm(kmart ~ log_pop + log_ret + urban_pct + midwest + south + walmart, family = binomial(link = "probit"), data = Xmat)
summary(k_reg)
summary(w_reg)
w_reg <- glm(walmart ~ log_pop  + urban_pct + midwest + south + log_benton_dist, family = binomial(link = "probit"), data = Xmat)
summary(w_reg)
w_reg <- glm(walmart ~ log_pop  + urban_pct + midwest + south + log_benton_dist + kmart, family = binomial(link = "probit"), data = Xmat)
w_reg <- glm(walmart ~ log_pop  + urban_pct + midwest + south + log_benton_dist + kmart, family = binomial(link = "probit"), data = Xmat)
summary(w_reg)
w_reg <- glm(walmart ~ log_pop  + log_ret + urban_pct + midwest + south + log_benton_dist + kmart, family = binomial(link = "probit"), data = Xmat)
summary(w_reg)
k_reg <- glm(kmart ~ log_pop + log_ret + urban_pct + midwest + south + walmart, family = binomial(link = "probit"), data = Xmat)
summary(k_reg)
k_reg <- glm(kmart ~ log_pop  + urban_pct + midwest + south + walmart, family = binomial(link = "probit"), data = Xmat)
summary(k_reg)
walmart_reg
summary(iv_prob_KM)
summary(w_reg)
summary(k_reg)
summary(walmart_reg)
summary(kmart_reg)
summary(w_reg)
#library(ivprobit)
#iv_prob_KM <- ivprobit(kmart ~ log_pop + log_ret + urban_pct + midwest + south | walmart | log_pop + log_ret + urban_pct + midwest + south +log_benton_dist, Xmat)
##summary(iv_prob_KM)
#pred_km_prob <- fitted(iv_prob_KM, Xmat, type="response")
pred_wm = predict(w_reg, Xmat, type="response")
pred_km = predict(k_reg, Xmat, type="response")
hist(as.numeric(pred_wm))
hist(as.numeric(pred_km))
Xmat$pred_wm <- as.numeric(pred_wm)
Xmat$pred_km <- as.numeric(pred_km)
Xmat$pih_w <- qnorm(Xmat$pred_wm) #log(Xmat$pred_wm) - log(1-Xmat$pred_wm)
Xmat$pih_k <- qnorm(Xmat$pred_km)
walmart_reg <- lm(pih_w ~ log_pop + log_ret + urban_pct + midwest + south+ kmart, Xmat)
kmart_reg <- lm(pih_k ~ log_pop + log_ret + urban_pct + midwest + south+ walmart, Xmat)
summary(walmart_reg)
summary(kmart_reg)
logLik(w_reg)
logLik(k_reg)
logLik(walmart_reg)
logLik(kmart_reg)
install.packages('Sieve')
library(sieve)
library(Sieve)
Xmat[:,1:3]
Xmat[1:3]
sieve.model <- sieve_preprocess(X = Xmat[2:3], basisN = 50, type='cosine')
sieve.fit <- sieve_solver(model = sieve.model, Y = Xmat[9])
sieve.fit <- sieve_solver(model = sieve.model, Y = Xmat$walmart)
sieve.fit
sieve.prediction <- sieve_predict(model = sieve.fit, testX = Xmat[2:3], testY = Xmat[9])
sieve.prediction
histogram(sieve.prediction)
hist(sieve.prediction)
hist(as.numeric(sieve.prediction)
)
hist(as.numeric(sieve.prediction[-1]))
hist(as.numeric(sieve.prediction[-3]))
hist(as.numeric(sieve.prediction[1]))
sieve.fit <- sieve_solver(model = sieve.model, Y = Xmat$walmart, family='binomial')
sieve.fit
predict(sieve.fit)
predictY(sieve.fit)
sieve.fit[1]
hist(as.numeric(sieve.fit[1]))
hist(unlist(sieve.fit[1]))
hist(unlist(sieve.fi))
hist(unlist(sieve.fit))
hist(unlist(as.numeric(sieve.fit))
)
hist(unlist(as.numeric(sieve.fit)))
hist(as.numeric(unlist(sieve.fit))
)
hist(unlist(as.numeric(unlist(sieve.fit)))
)
hist(unlist(as.numeric(unlist(sieve.fit))))
sieve.fit$beta_hat
histogram(sieve.fit$beta_hat)
hist(sieve.fit$beta_hat)
hist(as.numeric(sieve.fit$beta_hat)
)
fitted(sieve.fit)
predit(sieve.fit)
predict(sieve.fit)
sieve.fit$X
hist(sieve.fit$X[2])
hist(sieve.fit$X)
hist(sieve.fit$X[1])
hist(sieve.fit$X)
sieve.model <- sieve_preprocess(X = Xmat$log_pop + Xmat$log_ret + Xmat$log_benton_dist + Xmat$urban_pct + Xmat$midwest + Xmat$south + Xmat$kmart, basisN = 50, type='cosine')
sieve.fit <- sieve_solver(model = sieve.model, Y = Xmat$walmart, family='binomial')
hist(sieve.fit$X)
sieve.model <- sieve_preprocess(X = Xmat$log_pop + Xmat$log_ret +  Xmat$urban_pct + Xmat$midwest + Xmat$south + Xmat$kmart, basisN = 50, type='cosine')
sieve.fit <- sieve_solver(model = sieve.model, Y = Xmat$walmart, family='binomial')
hist(sieve.fit$X)
sieve.model <- sieve_preprocess(X = Xmat$log_pop + Xmat$log_ret +  Xmat$urban_pct + Xmat$midwest + Xmat$south, basisN = 50, type='cosine')
sieve.fit <- sieve_solver(model = sieve.model, Y = Xmat$walmart, family='binomial')
hist(sieve.fit$X)
hist(Xdat$walmar)
hist(Xdat$walmart)
hist(Xmat$walmart)
sieve.model_wm <- sieve_preprocess(X = Xmat$log_pop + Xmat$log_ret + Xmat$log_benton_dist + Xmat$urban_pct + Xmat$midwest + Xmat$south + Xmat$kmart, basisN = 50, type='cosine')
sieve.fit_wm <- sieve_solver(model = sieve.model, Y = Xmat$walmart, family='binomial')
hist(sieve.fit_wm$X)
sieve.model_wm <- sieve_preprocess(X = Xmat$log_pop + Xmat$log_ret + Xmat$urban_pct + Xmat$midwest + Xmat$south + Xmat$walmart, basisN = 50, type='cosine')
sieve.fit_wm <- sieve_solver(model = sieve.model, Y = Xmat$kmart, family='binomial')
sieve.model_km <- sieve_preprocess(X = Xmat$log_pop + Xmat$log_ret + Xmat$urban_pct + Xmat$midwest + Xmat$south + Xmat$walmart, basisN = 50, type='cosine')
sieve.fit_km <- sieve_solver(model = sieve.model, Y = Xmat$kmart, family='binomial')
hist(sieve.fit_km$X)
sieve.model_wm <- sieve_preprocess(X = Xmat$log_pop + Xmat$log_ret + Xmat$log_benton_dist + Xmat$urban_pct + Xmat$midwest + Xmat$south + Xmat$kmart, basisN = 50, type='cosine')
sieve.fit_wm <- sieve_solver(model = sieve.model, Y = Xmat$walmart, family='binomial')
hist(sieve.fit_wm$X)
sieve.model_km <- sieve_preprocess(X = Xmat$log_pop + Xmat$log_ret + Xmat$urban_pct + Xmat$midwest + Xmat$south + Xmat$walmart, basisN = 50, type='cosine')
sieve.fit_km <- sieve_solver(model = sieve.model, Y = Xmat$kmart, family='binomial')
hist(sieve.fit_km$X)
hist(sieve.fit_km$beta_hat)
hist(unlist(sieve.fit_km$beta_hat)
hist(unlist(sieve.fit_km$beta_hat))
sieve.model_wm <- sieve_preprocess(X = Xmat('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'kmart'), basisN = 50, type='cosine')
sieve.fit_wm <- sieve_solver(model = sieve.model, Y = Xmat$walmart, family='binomial')
hist(sieve.fit_wm$X)
sieve.model_km <- sieve_preprocess(X = Xmat('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'walmart'), basisN = 50, type='cosine')
sieve.model_wm <- sieve_preprocess(X = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'kmart')], basisN = 50, type='cosine')
sieve.fit_wm <- sieve_solver(model = sieve.model, Y = Xmat$walmart, family='binomial')
hist(sieve.fit_wm$X)
sieve.model_km <- sieve_preprocess(X = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'walmart')], basisN = 50, type='cosine')
sieve.fit_km <- sieve_solver(model = sieve.model, Y = Xmat$kmart, family='binomial')
hist(sieve.fit_km$X)
hist(sieve.fit_wm)
hist(sieve.fit_wm$Phi)
hist(sieve.fit_wm$x)
sieve.fit$X
sieve.fit$X[1]
sieve.fit$X[2]
sieve.fit$X[3]
sieve.fit$X[4]
sieve.fit$X[5]
sieve.fit_wm$X[5]
sieve.fit_km$X[5]
sieve.fit_wm$X[4]
sieve.fit_wm$X[10]
sieve.fit_km$X[10]
hist(sieve.fit_km)
hist(sieve.fit_km$Phi)
hist(sieve.fit_wm$Phi)
sieve.model_km
predict(sieve.model_km)
sieve.prediction
plot(sieve.prediction)
hist(sieve.prediction-)
hist(sieve.prediction)
hist(unlist(sieve.prediction)
)
size(sieve.prediction)
sizeof(sieve.prediction)
View(sieve.prediction)
View(sieve.prediction)
sieve.prediction[["predictY"]]
s_pred_wm <- sieve_predict(model=sieve.fit_wm, testX = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'kmart')], TestY = Xmat$walmart)
s_pred_wm <- sieve_predict(model=sieve.fit_wm, testX = Xmat, TestY = Xmat$walmart)
s_pred_wm <- sieve_predict(model=sieve.fit_wm, testX = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'kmart')])
s_pred_wm <- sieve_predict(model=sieve.fit_wm, testX = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'kmart')])
sieve.model_wm <- sieve_preprocess(X = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'kmart')], basisN = 50, type='cosine')
sieve.fit_wm <- sieve_solver(model = sieve.model, Y = Xmat$walmart, family='binomial')
s_pred_wm <- sieve_predict(model=sieve.fit_wm, testX = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'kmart')])
Xmat[,c('log_pop')]
s_pred_wm <- sieve_predict(model=sieve.fit_wm, testX = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'kmart')])
s_pred_wm <- sieve_predict(model=sieve.fit_wm, testX = Xmat)
s_pred_wm <- sieve_predict(model=sieve.fit_wm, testX = Xmat[1:2])
sieve.model_wm <- sieve_preprocess(X = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'kmart')], basisN = 50, type='cosine')
sieve.fit_wm <- sieve_solver(model = sieve.model_wm, Y = Xmat$walmart, family='binomial')
s_pred_wm <- sieve_predict(model=sieve.fit_wm, testX = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'kmart')])
sieve.model_km <- sieve_preprocess(X = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'walmart')], basisN = 50, type='cosine')
sieve.fit_km <- sieve_solver(model = sieve.model_km, Y = Xmat$kmart, family='binomial')
hist(sieve.fit_km$X)
hist(sieve.fit_wm$X)
s_pred_wm <- sieve_predict(model=sieve.fit_wm, testX = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'kmart')])
hist(s_pred_wm)
hist(as.numeric(s_pred_wm))
hist(as.numeric(unlist(s_pred_wm)))
hist(as.numeric(unlist(s_pred_km)))
s_pred_wm <- sieve_predict(model=sieve.fit_km, testX = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'walmart')])
hist(as.numeric(unlist(s_pred_km)))
s_pred_km <- sieve_predict(model=sieve.fit_km, testX = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'walmart')])
s_pred_km <- sieve_predict(model=sieve.fit_km, testX = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'walmart')])
hist(as.numeric(unlist(s_pred_km)))
s_pred_wm <- sieve_predict(model=sieve.fit_wm, testX = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'kmart')])
hist(as.numeric(unlist(s_pred_wm)))
hist(as.numeric(unlist(s_pred_km)))
count(s_pred_km)
object.size(s_pred_km)
length(s_pred_km)
length(s_pred_km[1])
length(unlist(s_pred_km)
)
length(unlist(s_pred_km)[1])
length(unlist(s_pred_km)[2])
length(unlist(s_pred_km[1]))
length(unlist(s_pred_km[2]))
length(unlist(s_pred_km[1,1]))
length(unlist(s_pred_km[:,1]))
length(unlist(s_pred_km)[:,1])
length(unlist(s_pred_km)(:,1))
length(unlist(s_pred_km[[1],:])
length(unlist(s_pred_km[[1],:]))
length(unlist(s_pred_km)[[1],:]))
length(unlist(s_pred_km)[[1],:])
length(unlist(s_pred_km)[[1],:])
unlist(s_pred_km)[[1],:])
unlist(s_pred_km[[1],:])
unlist(s_pred_km)[[1],:]
unlist(s_pred_km)[,1]
unlist(s_pred_km[,1])
s_pred_km[,1:81]
s_pred_km[1,1:81]
s_pred_km[1,1]
s_pred_km[1]
s_pred_km[1][1]
s_pred_km[1][2]
s_pred_km[2]
test <- unlist(s_pred_km[1])
display(test)
length(test)
test[1]
test[2]
test[10]
test <- as.numeric(s_pred_km[1])
test <- DataFrame(s_pred_km[1])
test <- data.frame(s_pred_km[1])
View(test)
hist(test$predictY.1)
hist(test$predictY.1, bins=50)
hist(test$predictY.1, breaks=30)
hist(test$predictY.10)
hist(test$predictY.3)
hist(test$predictY.50)
test$sumrow <- rowSums(test, na.rm = TRUE)
View(test)
test$sumrow <- test$sumrow/85
hist(test$sumrow)
km_pred <- data.frame(s_pred_km[1])
km_pred$pred_km <- rowSums(km_pred, na.rm = TRUE)/85
plot(km_pred$pred_km)
wm_pred <- data.frame(s_pred_wm[1])
wm_pred$pred_wm <- rowSums(wm_pred, na.rm = TRUE)/85
hist(wm_pred$pred_wm)
View(wm_pred)
hist(as.numeric(unlist(s_pred_wm)))
wm_pred <- data.frame(s_pred_wm[1])
wm_pred$pred_wm <- rowSums(wm_pred, na.rm = TRUE)/100
hist(as.numeric(unlist(s_pred_wm)))
hist(wm_pred$pred_wm)
maximum(wm_pred$pred_wm)
max(wm_pred$pred_wm)
min(wm_pred$pred_wm)
sieve.model_km <- sieve_preprocess(X = Xmat[, c('log_pop', 'log_ret',  'urban_pct', 'midwest', 'south', 'walmart')], basisN = 50, type='cosine')
sieve.fit_km <- sieve_solver(model = sieve.model_km, Y = Xmat$kmart, family='binomial')
s_pred_km <- sieve_predict(model=sieve.fit_km, testX = Xmat[, c('log_pop', 'log_ret',  'urban_pct', 'midwest', 'south', 'walmart')])
km_pred <- data.frame(s_pred_km[1])
View(km_pred)
km_pred$pred_km <- rowSums(km_pred, na.rm = TRUE)/100
hist(km_pred$pred_km)
max(km_pred$pred_km)
View(km_pred)
plot(km_pred$pred_km, Xmat$kmart)
plot(km_pred$pred_km, Xmat$pred_km)
plot(wm_pred$pred_wm, Xmat$pred_wm)
sieve.model_wm <- sieve_preprocess(X = Xmat[, c('log_pop', 'log_ret',  'urban_pct', 'midwest', 'south', 'kmart')], basisN = 50, type='cosine')
sieve.fit_wm <- sieve_solver(model = sieve.model_wm, Y = Xmat$walmart, family='binomial')
s_pred_wm <- sieve_predict(model=sieve.fit_wm, testX = Xmat[, c('log_pop', 'log_ret',   'urban_pct', 'midwest', 'south', 'kmart')])
wm_pred <- data.frame(s_pred_wm[1])
View(wm_pred)
wm_pred$pred_wm <- rowSums(wm_pred, na.rm = TRUE)/83
plot(wm_pred$pred_wm, Xmat$pred_wm)
sieve.model_km <- sieve_preprocess(X = Xmat[, c('log_pop', 'log_ret',  'urban_pct', 'midwest', 'south', 'walmart')], basisN = 50, type='cosine')
sieve.fit_km <- sieve_solver(model = sieve.model_km, Y = Xmat$kmart, family='binomial')
s_pred_km <- sieve_predict(model=sieve.fit_km, testX = Xmat[, c('log_pop', 'log_ret',  'urban_pct', 'midwest', 'south', 'walmart')])
km_pred <- data.frame(s_pred_km[1])
km_pred$pred_km <- rowSums(km_pred, na.rm = TRUE)/100
plot(wm_pred$pred_wm, Xmat$pred_wm)
sieve.model_wm <- sieve_preprocess(X = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'kmart')], basisN = 50, type='cosine')
sieve.fit_wm <- sieve_solver(model = sieve.model_wm, Y = Xmat$walmart, family='binomial')
s_pred_wm <- sieve_predict(model=sieve.fit_wm, testX = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'kmart')])
s_pred_wm <- sieve_predict(model=sieve.fit_wm, testX = Xmat[, c('log_pop', 'log_ret', 'log_benton_dist',  'urban_pct', 'midwest', 'south', 'kmart')])
wm_pred <- data.frame(s_pred_wm[1])
wm_pred$pred_wm <- rowSums(wm_pred, na.rm = TRUE)/100
wm_pred$pred_wm <- rowSums(wm_pred, na.rm = TRUE)/100
wm_pred <- data.frame(s_pred_wm[1])
wm_pred$pred_wm <- rowSums(wm_pred, na.rm = TRUE)/100
plot(wm_pred$pred_wm, Xmat$pred_wm)
lm(wm_pred$pred_wm ~ Xmat$pred_wm)
lm(wm_pred$pred_wm ~ Xmat$pred_wm-1)
plot(km_pred$pred_km, Xmat$pred_km)
lm(km_pred$pred_km ~ Xmat$pred_km-1)
lm(km_pred$pred_km ~ Xmat$pred_km)
wm_sieve <- data.frame(s_pred_wm[1])
wm_sieve$pred_wm <- rowSums(wm_pred, na.rm = TRUE)/100
km_sieve <- data.frame(s_pred_km[1])
wm_sieve$pred_wm <- rowSums(wm_sieve, na.rm = TRUE)/100
km_sieve <- data.frame(s_pred_km[1])
km_sieve$pred_km <- rowSums(km_sieve, na.rm = TRUE)/100
Xmat$sieve_wm <- wm_sieve$pred_wm
Xmat$sieve_km <- km_sieve$pred_km
Xmat$pih_w_s <- qnorm(Xmat$sieve_wm)
Xmat$pih_k_s <- qnorm(Xmat$sieve_km)
wm_step2_reg <- lm(pih_w ~ log_pop  + log_ret + urban_pct + midwest + south + log_benton_dist + kmart, data = Xmat)
km_step2_reg <- lm(pih_k ~ log_pop  + log_ret + urban_pct + midwest + south + walmart, data = Xmat)
summary(wm_step2_reg)
summary(km_step2_reg)
wm_sieve_reg <- lm(pih_w_s ~ log_pop  + log_ret + urban_pct + midwest + south + log_benton_dist + kmart, data = Xmat)
km_sieve_reg <- lm(pih_k_s ~ log_pop  + log_ret + urban_pct + midwest + south + walmart, data = Xmat)
summary(wm_step2_reg)
summary(km_step2_reg)
stargazer(wm_step2_reg, wm_sieve_reg, km_step2_reg, km_sieve_reg)
library(stargazer)
stargazer(wm_step2_reg, wm_sieve_reg, km_step2_reg, km_sieve_reg)
k_reg <- glm(kmart ~ log_pop  + log_ret + urban_pct + midwest + south + walmart, family = binomial(link = "probit"), data = Xmat)
#library(ivprobit)
#iv_prob_KM <- ivprobit(kmart ~ log_pop + log_ret + urban_pct + midwest + south | walmart | log_pop + log_ret + urban_pct + midwest + south +log_benton_dist, Xmat)
##summary(iv_prob_KM)
#pred_km_prob <- fitted(iv_prob_KM, Xmat, type="response")
pred_wm = predict(w_reg, Xmat, type="response")
pred_km = predict(k_reg, Xmat, type="response")
hist(as.numeric(pred_wm))
hist(as.numeric(pred_km))
Xmat$pred_wm <- as.numeric(pred_wm)
Xmat$pred_km <- as.numeric(pred_km)
Xmat$pih_w <- qnorm(Xmat$pred_wm) #log(Xmat$pred_wm) - log(1-Xmat$pred_wm)
Xmat$pih_k <- qnorm(Xmat$pred_km)
wm_step2_reg <- lm(pih_w ~ log_pop  + log_ret + urban_pct + midwest + south + log_benton_dist + kmart, data = Xmat)
km_step2_reg <- lm(pih_k ~ log_pop  + log_ret + urban_pct + midwest + south + walmart, data = Xmat)
summary(wm_step2_reg)
summary(km_step2_reg)
Xmat$sieve_wm <- wm_sieve$pred_wm
Xmat$sieve_km <- km_sieve$pred_km
Xmat$pih_w_s <- qnorm(Xmat$sieve_wm)
Xmat$pih_k_s <- qnorm(Xmat$sieve_km)
wm_sieve_reg <- lm(pih_w_s ~ log_pop  + log_ret + urban_pct + midwest + south + log_benton_dist + kmart, data = Xmat)
km_sieve_reg <- lm(pih_k_s ~ log_pop  + log_ret + urban_pct + midwest + south + walmart, data = Xmat)
summary(wm_step2_reg)
summary(km_step2_reg)
stargazer(wm_step2_reg, wm_sieve_reg, km_step2_reg, km_sieve_reg)
km_step2_reg <- lm(pih_k ~ log_pop  + log_ret + urban_pct + midwest + south + pred_wm, data = Xmat)
summary(wm_step2_reg)
summary(km_step2_reg)
hist(km_pred$predictY.100)
plot(km_pred$predictY.100, Xmat$pred_km)
plot(wm_pred$predictY.100, Xmat$pred_wm)
plot(Xmat$sieve_wm, Xmat$pred_wm)
plot(wm_pred$predictY.100, Xmat$pred_wm)
plot(1:100, wm_pred[1])
plot(1:100, wm_pred[1,])
wm_pred[1]
wm_pred[,1]
flush.console()
wm_pred[1,]
plot(1:100, wm_pred[1,])
1:100
plot(wm_pred[1,]
)
plot(wm_pred[1,])
plot(as.numeric(wm_pred[1,])
)
plot(as.numeric(wm_pred[3,])
)
plot(as.numeric(wm_pred[4,])
)
plot(as.numeric(wm_pred[5,]))
plot(as.numeric(wm_pred[6,]))
plot(wm_pred[100], Xmat$walmart)
plot(as.numeric(wm_pred[100]), Xmat$walmart)
plot(as.numeric(unlist(wm_pred[100]), Xmat$walmart)
)
plot(as.numeric(unlist(wm_pred[100])), Xmat$walmart)
plot(Xmat$walmart, unlist(wm_pred[100]))
pred_test <- (wm_pred[100] > 0.5)
plot(Xmat$walmart, pred_test)
mean(Xmat$walmart - pred_test)
mean((Xmat$walmart - pred_test)^2)
plot(Xmat$walmart - unlist(wm_pred[100]))
plot(Xmat$walmart - Xmat$pred_wm)
mean((Xmat$walmart - Xmat$pred_wm)^2)
mean(Xmat$walmart - Xmat$pred_wm)
wm_sieve <- data.frame(s_pred_wm[1])[100]
km_sieve <- data.frame(s_pred_km[1])[100]
plot(km_sieve)
plot(km_sieve, Xmat$pred_km)
plot(as.numeric(km_sieve), Xmat$pred_km)
plot(unlist(km_sieve), Xmat$pred_km)
wm_sieve <- unlist(data.frame(s_pred_wm[1])[100])
km_sieve <- unlist(data.frame(s_pred_km[1])[100])
Xmat$sieve_wm <- wm_sieve$pred_wm
Xmat$sieve_wm <- wm_sieve
Xmat$sieve_km <- km_sieve
Xmat$pih_w_s <- qnorm(Xmat$sieve_wm)
Xmat$pih_k_s <- qnorm(Xmat$sieve_km)
wm_sieve_reg <- lm(pih_w_s ~ log_pop  + log_ret + urban_pct + midwest + south + log_benton_dist + kmart, data = Xmat)
km_sieve_reg <- lm(pih_k_s ~ log_pop  + log_ret + urban_pct + midwest + south + walmart, data = Xmat)
summary(wm_step2_reg)
summary(km_step2_reg)
logLik(wm_step2_reg)
wm_sieve_reg <- lm(pih_w_s ~ log_pop  + log_ret + urban_pct + midwest + south + log_benton_dist + pred_km, data = Xmat)
km_sieve_reg <- lm(pih_k_s ~ log_pop  + log_ret + urban_pct + midwest + south + pred_wm, data = Xmat)
summary(wm_step2_reg)
summary(km_step2_reg)
library(gmm)
install.packages(gmm)
install.packages('gmm')
wm_sieve_reg <- lm(pih_w_s ~ log_pop  + log_ret + urban_pct + midwest + south + log_benton_dist + sieve_km, data = Xmat)
km_sieve_reg <- lm(pih_k_s ~ log_pop  + log_ret + urban_pct + midwest + south + sieve_wm, data = Xmat)
summary(wm_step2_reg)
summary(km_step2_reg)
gmm(pih_w_s ~ log_pop + log_ret + urban_pct + midwest + south + log_benton_dist + sieve_km, data = Xmat, type='iterative', wmatrix='optimal')
library(gmm)
library(gmm)
gmm(pih_w_s ~ log_pop + log_ret + urban_pct + midwest + south + log_benton_dist + sieve_km, data = Xmat, type='iterative', wmatrix='optimal')
install.packages('sandwith')
install.packages('sandwich')
library(sandwich)
library(gmm)
library(dylib)
locate libgomp.1.dylib
library(gmm)
library(gmm)
install.packages('gmm')
library(gmm)
library(sandwich)
library(gmm)
